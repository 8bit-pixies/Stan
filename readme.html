<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Statistical Analysis System (SAS) Transcompiler to SciPy &mdash; Stan 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Stan 0.0.1 documentation" href="index.html" />
    <link rel="next" title="Installation" href="installation.html" />
    <link rel="prev" title="Welcome to stan’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to stan’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Stan 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Statistical Analysis System (SAS) Transcompiler to SciPy</a><ul>
<li><a class="reference internal" href="#testing">Testing</a></li>
<li><a class="reference internal" href="#differences">Differences</a></li>
<li><a class="reference internal" href="#known-issues">Known Issues</a></li>
<li><a class="reference internal" href="#will-not-suport">Will not Suport</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to stan&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="installation.html"
                        title="next chapter">Installation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/readme.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="statistical-analysis-system-sas-transcompiler-to-scipy">
<h1>Statistical Analysis System (SAS) Transcompiler to SciPy<a class="headerlink" href="#statistical-analysis-system-sas-transcompiler-to-scipy" title="Permalink to this headline">¶</a></h1>
<img alt="https://travis-ci.org/chappers/Stan.png?branch=dev:target:https://travis-ci.org/chappers/Stan" src="https://travis-ci.org/chappers/Stan.png?branch=dev:target:https://travis-ci.org/chappers/Stan" />
<p>The goal of this is to transcompile a subset of SAS/Base to SciPy.</p>
<div class="section" id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<p>The tests can be run directly inside your git clone (without having to install stan) by typing:</p>
<blockquote>
<div>nosetests stan</div></blockquote>
</div>
<div class="section" id="differences">
<h2>Differences<a class="headerlink" href="#differences" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">data</span> <span class="pre">merge</span></tt> will not require the data to be sorted before hand. Data will be implicitly sorted
(similar to the SPDE engine).</li>
<li><tt class="docutils literal"><span class="pre">dates</span></tt> will be suppported in a different manner (coming soon).</li>
<li><tt class="docutils literal"><span class="pre">format</span></tt>, <tt class="docutils literal"><span class="pre">length</span></tt>, <tt class="docutils literal"><span class="pre">informats</span></tt> will not be necessary (we shall use <tt class="docutils literal"><span class="pre">dtype</span></tt> in <tt class="docutils literal"><span class="pre">numpy</span></tt>).</li>
<li>Pandas supports column names with spaces in it. This may cause issues since SAS automatically changes spaces to <tt class="docutils literal"><span class="pre">_</span></tt>.</li>
<li>Pandas is case sensitive, SAS is not.</li>
</ul>
</div>
<div class="section" id="known-issues">
<h2>Known Issues<a class="headerlink" href="#known-issues" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="will-not-suport">
<h2>Will not Suport<a class="headerlink" href="#will-not-suport" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">macro</span></tt> facility. It can be replicated (to a degree) using <a class="reference external" href="http://ipython.org/ipython-doc/rel-1.1.0/interactive/reference.html#input-caching-system">iPython</a>.</li>
</ul>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">stan.transcompile</span> <span class="kn">import</span> <span class="n">transcompile</span>
<span class="kn">import</span> <span class="nn">stan.stan_magic</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pkgutil</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">nan</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">stan.proc_functions</span> <span class="kn">as</span> <span class="nn">proc_func</span>

<span class="n">mod_name</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;from stan.proc_functions import </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">name</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">iter_modules</span><span class="p">(</span><span class="n">proc_func</span><span class="o">.</span><span class="n">__path__</span><span class="p">)]</span>
<span class="k">exec</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mod_name</span><span class="p">))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># create an example data frame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="s">&#39;e&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.245481</td>
      <td>-1.609963</td>
      <td> 0.442550</td>
      <td>-0.056406</td>
      <td>-0.213349</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.118754</td>
      <td> 0.116146</td>
      <td>-0.032579</td>
      <td>-0.556940</td>
      <td> 0.270678</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 0.864960</td>
      <td>-0.479118</td>
      <td> 2.370390</td>
      <td> 2.090656</td>
      <td>-0.475426</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 0.434934</td>
      <td>-2.510176</td>
      <td> 0.122871</td>
      <td> 0.077915</td>
      <td> 0.597477</td>
    </tr>
    <tr>
      <th>4</th>
      <td> 0.689308</td>
      <td> 0.042817</td>
      <td> 0.217040</td>
      <td>-1.424120</td>
      <td>-0.214721</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.432170</td>
      <td>-1.344882</td>
      <td>-0.055934</td>
      <td> 1.921247</td>
      <td> 1.519922</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.837277</td>
      <td> 0.944802</td>
      <td>-0.650114</td>
      <td>-0.297314</td>
      <td> 1.432118</td>
    </tr>
    <tr>
      <th>7</th>
      <td> 1.488292</td>
      <td>-1.236296</td>
      <td> 0.128023</td>
      <td> 2.886408</td>
      <td>-0.560200</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.510566</td>
      <td>-1.736577</td>
      <td> 0.066769</td>
      <td>-0.735257</td>
      <td> 0.178167</td>
    </tr>
    <tr>
      <th>9</th>
      <td> 2.540022</td>
      <td> 0.034493</td>
      <td>-0.521496</td>
      <td>-2.189938</td>
      <td> 0.111702</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-python"><div class="highlight"><pre>%%stan
data test;
set df (drop = a);
run;
</pre></div>
</div>
<pre class="literal-block">
u&quot;test=df.drop(['a'],1)n&quot;
</pre>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">exec</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="n">test</span>
</pre></div>
</div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.609963</td>
      <td> 0.442550</td>
      <td>-0.056406</td>
      <td>-0.213349</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 0.116146</td>
      <td>-0.032579</td>
      <td>-0.556940</td>
      <td> 0.270678</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.479118</td>
      <td> 2.370390</td>
      <td> 2.090656</td>
      <td>-0.475426</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-2.510176</td>
      <td> 0.122871</td>
      <td> 0.077915</td>
      <td> 0.597477</td>
    </tr>
    <tr>
      <th>4</th>
      <td> 0.042817</td>
      <td> 0.217040</td>
      <td>-1.424120</td>
      <td>-0.214721</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-1.344882</td>
      <td>-0.055934</td>
      <td> 1.921247</td>
      <td> 1.519922</td>
    </tr>
    <tr>
      <th>6</th>
      <td> 0.944802</td>
      <td>-0.650114</td>
      <td>-0.297314</td>
      <td> 1.432118</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-1.236296</td>
      <td> 0.128023</td>
      <td> 2.886408</td>
      <td>-0.560200</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-1.736577</td>
      <td> 0.066769</td>
      <td>-0.735257</td>
      <td> 0.178167</td>
    </tr>
    <tr>
      <th>9</th>
      <td> 0.034493</td>
      <td>-0.521496</td>
      <td>-2.189938</td>
      <td> 0.111702</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-python"><div class="highlight"><pre>%%stan
data df_if;
    set df;
    if b &lt; 0.3 then x = 0;
    else if b &lt; 0.6 then x = 1;
    else x = 2;
run;
</pre></div>
</div>
<pre class="literal-block">
u&quot;df_if=dfnfor el in ['x']:n    if el not in df_if.columns:n        df_if[el] = np.nanndf_if.ix[((df_if[u'b']&lt;0.3)), 'x'] = (0)nfor el in ['x']:n    if el not in df_if.columns:n        df_if[el] = np.nanndf_if.ix[((~((df_if[u'b']&lt;0.3))) &amp; (df_if[u'b']&lt;0.6)), 'x'] = (1)ndf_if.ix[((~((df_if[u'b']&lt;0.6))) &amp; (~((df_if[u'b']&lt;0.3)))), 'x'] = (2)n&quot;
</pre>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">exec</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="n">df_if</span>
</pre></div>
</div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
      <th>x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.245481</td>
      <td>-1.609963</td>
      <td> 0.442550</td>
      <td>-0.056406</td>
      <td>-0.213349</td>
      <td> 0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.118754</td>
      <td> 0.116146</td>
      <td>-0.032579</td>
      <td>-0.556940</td>
      <td> 0.270678</td>
      <td> 0</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 0.864960</td>
      <td>-0.479118</td>
      <td> 2.370390</td>
      <td> 2.090656</td>
      <td>-0.475426</td>
      <td> 0</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 0.434934</td>
      <td>-2.510176</td>
      <td> 0.122871</td>
      <td> 0.077915</td>
      <td> 0.597477</td>
      <td> 0</td>
    </tr>
    <tr>
      <th>4</th>
      <td> 0.689308</td>
      <td> 0.042817</td>
      <td> 0.217040</td>
      <td>-1.424120</td>
      <td>-0.214721</td>
      <td> 0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.432170</td>
      <td>-1.344882</td>
      <td>-0.055934</td>
      <td> 1.921247</td>
      <td> 1.519922</td>
      <td> 0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.837277</td>
      <td> 0.944802</td>
      <td>-0.650114</td>
      <td>-0.297314</td>
      <td> 1.432118</td>
      <td> 2</td>
    </tr>
    <tr>
      <th>7</th>
      <td> 1.488292</td>
      <td>-1.236296</td>
      <td> 0.128023</td>
      <td> 2.886408</td>
      <td>-0.560200</td>
      <td> 0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.510566</td>
      <td>-1.736577</td>
      <td> 0.066769</td>
      <td>-0.735257</td>
      <td> 0.178167</td>
      <td> 0</td>
    </tr>
    <tr>
      <th>9</th>
      <td> 2.540022</td>
      <td> 0.034493</td>
      <td>-0.521496</td>
      <td>-2.189938</td>
      <td> 0.111702</td>
      <td> 0</td>
    </tr>
  </tbody>
</table>
</div><hr class="docutils" />
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># procs can be added manually they can be thought of as python functions</span>
<span class="c"># you can define your own, though I need to work on the parser</span>
<span class="c"># to get it &quot;smooth&quot;</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;a&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">&#39;b&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">},</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">df1</span>
</pre></div>
</div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>  True</td>
      <td> False</td>
    </tr>
    <tr>
      <th>1</th>
      <td> False</td>
      <td>  True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>  True</td>
      <td>  True</td>
    </tr>
  </tbody>
</table>
</div><div class="code python highlight-python"><div class="highlight"><pre>%%stan
proc describe data = df1 out = df2;
by a;
run;
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="s">u&quot;df2=describe.describe(data=df1,by=&#39;a&#39;)&quot;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">exec</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="n">df2</span>
</pre></div>
</div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
    <tr>
      <th>a</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="8" valign="top">False</th>
      <th>count</th>
      <td>     1</td>
      <td>         1</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>     0</td>
      <td>         1</td>
    </tr>
    <tr>
      <th>std</th>
      <td>   NaN</td>
      <td>       NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td> False</td>
      <td>      True</td>
    </tr>
    <tr>
      <th>25%</th>
      <td> False</td>
      <td>      True</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>     0</td>
      <td>         1</td>
    </tr>
    <tr>
      <th>75%</th>
      <td> False</td>
      <td>      True</td>
    </tr>
    <tr>
      <th>max</th>
      <td> False</td>
      <td>      True</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">True </th>
      <th>count</th>
      <td>     2</td>
      <td>         2</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>     1</td>
      <td>       0.5</td>
    </tr>
    <tr>
      <th>std</th>
      <td>     0</td>
      <td> 0.7071068</td>
    </tr>
    <tr>
      <th>min</th>
      <td>  True</td>
      <td>     False</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>     1</td>
      <td>      0.25</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>     1</td>
      <td>       0.5</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>     1</td>
      <td>      0.75</td>
    </tr>
    <tr>
      <th>max</th>
      <td>  True</td>
      <td>      True</td>
    </tr>
  </tbody>
</table>
</div><p>The proc actually isn&#8217;t difficult to write. So for the above code it is</p>
<p>actually just this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">by</span><span class="p">):</span>

    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<p>This functionality allow you to handle most of the <tt class="docutils literal"><span class="pre">by</span></tt> and <tt class="docutils literal"><span class="pre">retain</span></tt></p>
<p>cases. For languages like Python and R, the normal way to handle data is</p>
<p>through the split-apply-combine methodology.</p>
<p>Merges can be achieved in a similar way, by creating a <tt class="docutils literal"><span class="pre">proc</span></tt>:</p>
<div class="code python highlight-python"><div class="highlight"><pre>%%stan
proc merge out = df2;
dt_left left;
dt_right right;
on = &#39;key&#39;;
run;
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="s">u&quot;df2=merge.merge(dt_left=left,dt_right=right,on=&#39;key&#39;)&quot;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">left</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">],</span> <span class="s">&#39;lval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">],</span> <span class="s">&#39;rval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>

<span class="k">exec</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="n">df2</span>
</pre></div>
</div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>lval</th>
      <th>rval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> foo</td>
      <td> 1</td>
      <td> 4</td>
    </tr>
    <tr>
      <th>1</th>
      <td> foo</td>
      <td> 1</td>
      <td> 5</td>
    </tr>
    <tr>
      <th>2</th>
      <td> foo</td>
      <td> 2</td>
      <td> 4</td>
    </tr>
    <tr>
      <th>3</th>
      <td> foo</td>
      <td> 2</td>
      <td> 5</td>
    </tr>
  </tbody>
</table>
</div><p>heres an example showing how you can define your own function and run it</p>
<p>(not a function that came with the package)</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">sum_mean_by</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">by</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre>%%stan
proc sum_mean_by data = df_if out = df_sum;
by x;
run;
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="s">u&quot;df_sum=sum_mean_by(data=df_if,by=&#39;x&#39;)&quot;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">exec</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="n">df_sum</span>
</pre></div>
</div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">a</th>
      <th colspan="2" halign="left">b</th>
      <th colspan="2" halign="left">c</th>
      <th colspan="2" halign="left">d</th>
      <th colspan="2" halign="left">e</th>
    </tr>
    <tr>
      <th></th>
      <th>sum</th>
      <th>mean</th>
      <th>sum</th>
      <th>mean</th>
      <th>sum</th>
      <th>mean</th>
      <th>sum</th>
      <th>mean</th>
      <th>sum</th>
      <th>mean</th>
    </tr>
    <tr>
      <th>x</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 2.710545</td>
      <td> 0.301172</td>
      <td>-8.723557</td>
      <td>-0.969284</td>
      <td> 2.737635</td>
      <td> 0.304182</td>
      <td> 2.013566</td>
      <td> 0.223730</td>
      <td> 1.214251</td>
      <td> 0.134917</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.837277</td>
      <td>-0.837277</td>
      <td> 0.944802</td>
      <td> 0.944802</td>
      <td>-0.650114</td>
      <td>-0.650114</td>
      <td>-0.297314</td>
      <td>-0.297314</td>
      <td> 1.432118</td>
      <td> 1.432118</td>
    </tr>
  </tbody>
</table>
</div><p><tt class="docutils literal"><span class="pre">proc</span> <span class="pre">sql</span></tt> is supported through the <tt class="docutils literal"><span class="pre">pandasql</span></tt> library. So the above</p>
<p>table could have been produced via SQL as well.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pandasql</span>

<span class="n">q</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">select</span>
<span class="s">    sum(a) as sum_a,</span>
<span class="s">    sum(b) as sum_b,</span>
<span class="s">    sum(c) as sum_c,</span>
<span class="s">    sum(d) as sum_d,</span>
<span class="s">    sum(e) as sum_e,</span>
<span class="s">    avg(a) as avg_a,</span>
<span class="s">    avg(b) as avg_b,</span>
<span class="s">    avg(c) as avg_c,</span>
<span class="s">    avg(d) as avg_d,</span>
<span class="s">    avg(e) as avg_e</span>
<span class="s">from</span>
<span class="s">    df_if</span>
<span class="s">group by x</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">df_sum_sql</span> <span class="o">=</span> <span class="n">pandasql</span><span class="o">.</span><span class="n">sqldf</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">locals</span><span class="p">())</span>
<span class="n">df_sum_sql</span>
</pre></div>
</div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sum_a</th>
      <th>sum_b</th>
      <th>sum_c</th>
      <th>sum_d</th>
      <th>sum_e</th>
      <th>avg_a</th>
      <th>avg_b</th>
      <th>avg_c</th>
      <th>avg_d</th>
      <th>avg_e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 2.710545</td>
      <td>-8.723557</td>
      <td> 2.737635</td>
      <td> 2.013566</td>
      <td> 1.214251</td>
      <td> 0.301172</td>
      <td>-0.969284</td>
      <td> 0.304182</td>
      <td> 0.223730</td>
      <td> 0.134917</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.837277</td>
      <td> 0.944802</td>
      <td>-0.650114</td>
      <td>-0.297314</td>
      <td> 1.432118</td>
      <td>-0.837277</td>
      <td> 0.944802</td>
      <td>-0.650114</td>
      <td>-0.297314</td>
      <td> 1.432118</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to stan’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">Stan 0.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright Stan.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>